---
title: NOI2024 前模拟赛
date: 2024-05-07 20:56:19
tags:
---
# 练功
练内功。
## 5.7

$13/100+0/100+3/3$

怎么有人文件都不会写了。

### T1

#### 题面
> 暂时不能给你明确的答复！。
#### Sol
考虑一个观察：限制非常的宽，如果我们随机给这些方程加一些限制，然后尝试解出这个方程（可能无解或重复），期望 $O(M)$ 次就可以得到 $M$ 个本质不同的解。这一步需要一定的胆子和数学直觉。

一种做法是枚举 $x$，解关于 $y$ 的二次方程，但是需要算二次剩余。

还有一种做法是钦定 $y=kx$，然后枚举这个 $k$ 解关于 $x$ 的二次方程，注意到 $x=0$ 是这个方程的一个根，则另一个根可以直接通过韦达定理计算，无需解二次剩余。

### T2

#### 题面

记 $[n]={0,1,2,\ldots,n}$。

求：

$$\sum_{r=0}^{n-1}\bigg(\sum_{S\sube [nm-1]}\bigg[\bigg(\sum_{x\in S}x\bigg)\equiv r\pmod n\bigg]\bigg)^2$$

#### Sol

看到平方，先组合意义一下。

相当于选两个集合使得他们元素总和模 $n$ 相等，也就是两个集合元素总和作差模 $n$ 余 $0$，注意到我们是在模意义下计算作差，因此可以变成选两个集合，总和模 $n$ 余 $0$。

这相当于是 $0\sim n-1$，每个数字出现了 $2m$ 次的背包，求最后总和模 $n$ 余 $0$ 的方案数。

也就是求：

$$[x^0]\prod_{i=0}^{n-1}(1+x^i)^{2m} \bmod (x^n-1)$$

直接考虑单位根反演：

$$\dfrac{1}{n}\sum_{i=0}^{n-1}\prod_{j=0}^{n-1}(1+\omega_{n}^{ij})^{2m}$$

考虑 $ij\bmod n$ 的序列，发现只与 $\gcd(i,n)$ 有关。

那么可以枚举这个 $\gcd$，得到：

$$\dfrac{1}{n}\sum_{d|n} \varphi(d)\prod_{i=0}^{d-1}(1+\omega_d^{i})^{2m\frac{n}{d}}$$

考虑计算 $\prod_{i=0}^{n-1}(1+\omega_{n}^i)$。

这个式子有结论：其值为 $1+(-1)^{n-1}$。

到这里就可以直接枚举约数直接算了，复杂度为 $\mathcal{O}(\sqrt{n}+d(n)\log(n))$。

如何算 $\prod_{i=0}^{n-1}(1+\omega_{n}^i)$？

注意到我们有：

$$x^n-1=\prod_{i=0}^{n-1}(x-\omega_{n}^{i})$$

直接代入 $x=-1$ 就可以得到结论。

**看到题中（尤其是数数题）里有取模相关一定要考虑单位根啊啊啊啊啊啊啊啊。**

还有一种手法是推导原多项式 DFT 后的结果，与这种方法并无多大差别。

### T3

#### 题面：

Luogu P7729

#### Sol

太困难了。

具体地想法是维护出第一问的答案，发现一定是若干个连通块不动，剩下一个连通块变化一条边，然后找出最小环可以维护第一问，第二问不会。

最小环 $\mathcal{O}(nm)$ 可以建出 BFS 树然后考虑最多只有一条边不在树上。
